<div class="appointments">
  <div class="header">
    <h2>Appointments</h2>
    <button class="btn btn-primary" (click)="addAppointment()" *ngIf="!showForm">Schedule Appointment</button>
  </div>

  <div class="form-container" *ngIf="showForm">
    <h3>{{ editingAppointment ? 'Edit' : 'Schedule' }} Appointment</h3>
    <form (ngSubmit)="saveAppointment()">
      <div class="form-row">
        <div class="form-group">
          <label>Patient</label>
          <select class="form-control" [(ngModel)]="appointment.patientId" name="patientId" required>
            <option value="">Select Patient</option>
            <option *ngFor="let patient of patients" [value]="patient.id">{{ patient.firstName }} {{ patient.lastName }}</option>
          </select>
        </div>
        <div class="form-group">
          <label>Doctor</label>
          <select class="form-control" [(ngModel)]="appointment.doctorId" name="doctorId" required>
            <option value="">Select Doctor</option>
            <option *ngFor="let doctor of doctors" [value]="doctor.id">{{ doctor.firstName }} {{ doctor.lastName }} - {{ doctor.specialty }}</option>
          </select>
        </div>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label>Status</label>
          <select class="form-control" [(ngModel)]="appointment.status" name="status" required>
            <option value="Scheduled">Scheduled</option>
            <option value="Completed">Completed</option>
            <option value="Cancelled">Cancelled</option>
          </select>
        </div>
        <div class="form-group">
          <label>Visit Fee</label>
          <input type="number" class="form-control" [(ngModel)]="appointment.visitFee" name="visitFee" step="0.01" min="0">
        </div>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label>Date</label>
          <input type="date" class="form-control" [(ngModel)]="appointment.appointmentDate" name="appointmentDate" required>
        </div>
        <div class="form-group">
          <label>Time</label>
          <input type="time" class="form-control" [(ngModel)]="appointment.appointmentTime" name="appointmentTime" required>
        </div>
      </div>
      <div class="form-group">
        <label>Reason for Visit</label>
        <input type="text" class="form-control" [(ngModel)]="appointment.reason" name="reason">
      </div>
      <div class="form-group">
        <label>Notes</label>
        <textarea class="form-control" rows="3" [(ngModel)]="appointment.notes" name="notes"></textarea>
      </div>
      <div class="form-actions">
        <button type="submit" class="btn btn-success">Save</button>
        <button type="button" class="btn btn-danger" (click)="cancelForm()">Cancel</button>
      </div>
    </form>
  </div>

  <div class="table-container" *ngIf="!showForm">
    <table class="table">
      <thead>
        <tr>
          <th>ID</th>
          <th>Patient</th>
          <th>Doctor</th>
          <th>Date</th>
          <th>Time</th>
          <th>Reason</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let appointment of appointments">
          <td>{{ appointment.id }}</td>
          <td>{{ getPatientName(appointment.patientId) }}</td>
          <td>{{ getDoctorName(appointment.doctorId) }}</td>
          <td>{{ appointment.appointmentDate }}</td>
          <td>{{ appointment.appointmentTime }}</td>
          <td>{{ appointment.reason }}</td>
          <td>{{ appointment.status }}</td>
          <td>
            <button class="btn btn-primary" (click)="editAppointment(appointment)">Edit</button>
            <button class="btn btn-danger" (click)="deleteAppointment(appointment.id!)">Delete</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
