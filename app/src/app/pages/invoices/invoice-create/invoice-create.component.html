<div class="min-h-screen bg-gray-50 p-8">
  <div class="max-w-4xl mx-auto">
    <div class="mb-6">
      <button (click)="cancel()" 
        class="text-blue-600 hover:text-blue-800 flex items-center">
        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
        </svg>
        Back to Invoices
      </button>
    </div>

    <h1 class="text-3xl font-bold text-gray-900 mb-8">Create New Invoice</h1>
    
    <div class="bg-white rounded-lg shadow-md p-6">
      <form (ngSubmit)="saveInvoice()" class="space-y-6">
        <!-- Basic Invoice Information -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <label for="invoiceNumber" class="block text-sm font-medium text-gray-700 mb-2">Invoice Number</label>
            <input 
              type="text" 
              id="invoiceNumber"
              [(ngModel)]="invoice.invoiceNumber" 
              name="invoiceNumber"
              required
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          </div>
          <div>
            <label for="appointmentId" class="block text-sm font-medium text-gray-700 mb-2">Appointment</label>
            <select 
              id="appointmentId"
              [(ngModel)]="invoice.appointmentId" 
              name="appointmentId"
              (change)="onAppointmentChange()"
              required
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
              <option value="0">Select Appointment</option>
              <option *ngFor="let appointment of appointments" [value]="appointment.id">
                Appointment #{{ appointment.id }} - {{ appointment.appointmentDate | date:'short' }}
              </option>
            </select>
          </div>
        </div>

        <!-- Financial Information -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <div>
            <label for="subTotal" class="block text-sm font-medium text-gray-700 mb-2">Subtotal</label>
            <input 
              type="number" 
              id="subTotal"
              [(ngModel)]="invoice.subTotal" 
              name="subTotal"
              (input)="calculateTotals()"
              step="0.01"
              required
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          </div>
          <div>
            <label for="taxAmount" class="block text-sm font-medium text-gray-700 mb-2">Tax Amount</label>
            <input 
              type="number" 
              id="taxAmount"
              [(ngModel)]="invoice.taxAmount" 
              name="taxAmount"
              step="0.01"
              readonly
              class="w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100">
          </div>
          <div>
            <label for="totalAmount" class="block text-sm font-medium text-gray-700 mb-2">Total Amount</label>
            <input 
              type="number" 
              id="totalAmount"
              [(ngModel)]="invoice.totalAmount" 
              name="totalAmount"
              step="0.01"
              readonly
              class="w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100">
          </div>
        </div>

        <!-- Post-Visit Updates Section -->
        <div class="border-t pt-6">
          <h3 class="text-lg font-semibold text-gray-800 mb-4">Post-Visit Updates (Optional)</h3>
          
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label for="diagnosis" class="block text-sm font-medium text-gray-700 mb-2">Diagnosis</label>
              <textarea 
                id="diagnosis"
                [(ngModel)]="diagnosis" 
                name="diagnosis"
                rows="3"
                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                placeholder="Enter diagnosis details..."></textarea>
            </div>
            <div>
              <label for="medicalOrders" class="block text-sm font-medium text-gray-700 mb-2">Medical Orders</label>
              <textarea 
                id="medicalOrders"
                [(ngModel)]="medicalOrders" 
                name="medicalOrders"
                rows="3"
                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                placeholder="Enter medical orders..."></textarea>
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-4">
            <div>
              <label for="additionalCharges" class="block text-sm font-medium text-gray-700 mb-2">Additional Charges</label>
              <input 
                type="number" 
                id="additionalCharges"
                [(ngModel)]="additionalCharges" 
                name="additionalCharges"
                step="0.01"
                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div>
              <label for="medicationCost" class="block text-sm font-medium text-gray-700 mb-2">Medication Cost</label>
              <input 
                type="number" 
                id="medicationCost"
                [(ngModel)]="medicationCost" 
                name="medicationCost"
                step="0.01"
                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div>
              <label for="procedureCost" class="block text-sm font-medium text-gray-700 mb-2">Procedure Cost</label>
              <input 
                type="number" 
                id="procedureCost"
                [(ngModel)]="procedureCost" 
                name="procedureCost"
                step="0.01"
                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
          </div>

          <div class="mt-4">
            <button 
              type="button" 
              (click)="addPostVisitCharges()"
              class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-md transition duration-150">
              Add Post-Visit Charges
            </button>
          </div>
        </div>

        <!-- Notes -->
        <div>
          <label for="notes" class="block text-sm font-medium text-gray-700 mb-2">Notes</label>
          <textarea 
            id="notes"
            [(ngModel)]="invoice.notes" 
            name="notes"
            rows="3"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
            placeholder="Additional notes..."></textarea>
        </div>

        <!-- Action Buttons -->
        <div class="flex justify-end space-x-4 pt-6 border-t">
          <button 
            type="button" 
            (click)="cancel()"
            class="px-6 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition duration-150">
            Cancel
          </button>
          <button 
            type="submit"
            class="px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition duration-150">
            Create Invoice
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
